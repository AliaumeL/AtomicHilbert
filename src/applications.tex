% LTeX: language=en
%%!TEX root = ../atomic.asmart.tex
%
\section{Applications}
\label{sec:applications}

\subsection{Stabilty}

\todo[inline]{arka: create a new subsection: stability of our hypotheses, and place 
  it after the section on effective oligomorphisms. Because right now you do not prove
  that these constructions can be used to apply our results.
  Also, a table would be nice. This way, we can separate definitions/examples
  and the actual \emph{results} (that were all already proven somewhere else)
  in a simple table}

For the remainder of this section fix a pair of group actions
$\G\actson\X$ and $\calH\actson\Y$
%
\begin{example}\label{ex:union}
The group actions $\G\actson\X$ and $\calH\actson\Y$ can be extended to a group action $(\G\times\calH)\actson(\X\uplus\Y)$ by defining
\[
(\pi,\sigma)(z) =
\begin{cases}
\pi(z) & \text{if }z\in\X,\\
\sigma(z) & \text{if }z\in \Y.
\end{cases}
\]
\todo[inline]{what is the new linear ordering on the union?}
If the actions $\G\actson\X$ and $\calH\actson\Y$ preserve linear orders then so does the actions $(\G\times\calH)\actson(\X\uplus\Y)$.
Fix a \kl{WQO} $Q$.
We have
\[
(\mon[Q]{\X\uplus\Y}, \gdivleq[\G\times\calH])
\cong
(\mon[Q]{\X}\times\mon[Y]{\Y}, \gdivleq[\G]\times\gdivleq[\calH])
\]
where $\gdivleq[\G]\times\gdivleq[\calH]$ is the product of the orders $\gdivleq[\G]$ and $\gdivleq[\calH]$ defined as
\[
(x,y) \gdivleq[\G]\times\gdivleq[\calH] (x',y')
\quad
\text{if}
\quad
x \gdivleq[\G] x' \text{ and } y \gdivleq[\calH] y' \ .
\]
This implies if $(\mon[Q]{\X},\gdivleq{\G}$ and $(\mon[Q]{\Y},\gdivleq{\calH}$ are \kl{WQOs},
so is $(\mon[Q]{\X\uplus\Y}, \gdivleq[\G\times\calH])$ \cite[Lemma 1.5]{SCSC17}.
\end{example}
%
\begin{example}[\protect{\textnormal{\cite[Example 10]{GHOLAS24}}}]\label{ex:product}
We extend the group actions $\G\actson\X$ and $\calH\actson\Y$ to a group action $(\G \times \calH)\actson(\X\times\Y)$, as 
\[
(\pi,\sigma)((x,y)) = (\pi(x),\sigma(y)) \ .
\]
This group action corresponds to taking products of structures (\arka{citation}).
$(\mon[Q]{\X\times\Y}, \gdivleq[\G \times \calH])$ is not a \kl{WQO} even when $Q$ is a singleton.
For every element $q\in Q$ and two infinite sets $\{x_1,x_2,\dots\}\subseteq\X$ and $\{y_1,y_2,\dots\}\subseteq\Y$,
the set
\[
\setof{(x_1,y_1)^q(x_1,y_2)^q(x_2,y_2)\dots(x_{n-1},y_n)^q(x_n,y_n)^q(x_n,y_0)^q}{
n = 3,4,5,\dots} \subseteq \mon[Q]{\X\times\Y}
\]
is an infinite antichain.
\end{example}
%
The above example shows that products of structures do not preserve our \kl{WQO} property.
Now we show that the lexicographic product of structures
(\cite[Section 2]{GHOLAS24}) preserve this property.
\arka{any other citation?}
%
\begin{example}\label{ex:nested product}
Let $\G\otimes\calH$ be the group whose elements are of the form $(\pi,(\sigma^{x})_{x\in\X})$, where $\sigma_{x}\in\calH$ for every $x\in\X$.
Multiplication is defined as
\[
(\pi_1,(\sigma^{x}_1)_{x\in\X})\cdot(\pi_2,(\sigma^{x}_2)_{x\in\X})
=
(\pi_1\cdot\pi_2, (\sigma_1^{\pi_2(x)}\cdot\sigma_2^x)_{x\in\X}) \ .
\]
The action $\G\otimes\calH \actson \X\times\Y$ is given as
\[
(\pi,(\sigma^{x})_{x\in\X})(x',y') =
(\pi(x'),\sigma^{x'}(y'))\ , \text{ for }(x',y')\in\X\times\Y \ .
\]
Essentially,
each element $x\in\X$ carries its own copy $\{x\}\times\Y$ of the structure $\Y$,
and different copies of the structure $\Y$ can be permuted independently.
If $\G\actson\X$ and $\calH\actson\Y$ preserves the linear orders $<_{\X}$ and $<_{\Y}$, respectively,
then $\G\otimes\calH \actson \X\times\Y$ preserves the lexicographic linear order on $\X\times\Y$ defined as
\[
(x,y) <_{\ell ex} (x',y')\quad\text{if}\quad
\text{$x <_{\X} x'$, or $x = x'$ and $y <_{\Y} y'$.}
\]
Moreover, for every \kl{WQO} $Q$,
if $(\mon[Q]{\X},\gdivleq{\G})$ and $(\mon[Q]{\Y},\gdivleq{\calH})$ are \kl{WQOs},
so is $(\mon[Q]{\X\uplus\Y}, \gdivleq[\G\otimes\calH])$ \cite[Lemma 9]{GHOLAS24}.
\end{example}
%
%\paragraph{Sets with atoms.}
%
%
%\todo[inline]{Say that if one starts with atoms and equality, then we can only 
%  have dimension 1, and that this is the case of the rationals.}
%
%\paragraph{Relational structures.} Let $\mathbb{A}$ be an infinite relational
%structure with finitely many relations. Then, one can consider the set of
%polynomials $\poly{\K}{\mathbb{A}}$, where indeterminates are elements of the
%universe of $\mathbb{A}$. The group of all automorphisms of $\mathbb{A}$ (i.e.,
%bijections of the universe that preserve the relations) acts on
%$\poly{\K}{\mathbb{A}}$ by permuting the indeterminates.
%
%Natural examples are polynomials whose indeterminates are indexed by the
%natural numbers (with inequality), or the rationals (with inequality). In this
%setting, \kl{effective oligomorphcity} means that \todo{do it}. The fact that
%$(\mon{\mathbb{A}}, \gdivleq)$ is a well-quasi-ordering corresponds to ordering
%\emph{finite substructures} of $\mathbb{A}$ by the \emph{labelled induced
%substructure} relation, and asking whether the class obtained is
%well-quasi-ordered. This is a well-studied question in graph theory, where a
%conjecture of Pouzet states that this holds with two labels if and only if it
%holds for every ordinal. In particular, for such structures, it is therefore
%conjectured that $(\mon{\Indets}, \gdivleq)$ is a well-quasi-ordering if and
%only if $(\mon[\om \ordplus \ordfin{1}]{\Indets}, \gdivleq)$, $(\mon[\om
%\ordplus \om]{\Indets}, \gdivleq)$, and $(\mon[\om^2]{\Indets}, \gdivleq)$ are
%well-quasi-orderings too.
%\arka{So we can use any well-ordered set of labels?} 
%\todo[inline]{
%  Cite \cite{POUZ72},
%  \cite{DRT10} for the conjecture.
%}




\subsection{Computations using orbits.}
\paragraph{Polynomial computations.} \AP The fact that (finite control) systems
performing polynomial computations can be verified follows from the theory of
\kl{Gröbner bases} on finitely many indeterminates \cite{MULSEI02,BEDUSHWO17}.
There were also numerous applications to automata theory, such as deciding
whether a weighted automaton could be determinised (resp. desambiguated)
\cite{BESM23,PUSM24}. We refer the readers to a nice survey recapitulating the
successes of the ``Hilbert method'' automata theory \cite{BOJAN19}. A natural
consequence of the effective computations of \kl{equivariant Gröbner bases} is
that one can apply the same decision techniques to \emph{orbit finite
polynomial computations}. For simplicity and clarity, we will focus on
\kl{polynomial automata} without states or zero-tests \cite{BEDUSHWO17}, but
the same reasoning would apply to more general systems as we will discuss in
\cref{rem:topological-wsts}.


\AP Before discussing the case of orbit finite polynomial automata, let us
recall the setting of \kl{polynomial automata} in the classical case, as
studied by \cite{BEDUSHWO17}, with techniques that dates back to
\cite{MULSEI02}. A \intro{polynomial automaton} is a tuple $A \defined (Q,
\Sigma, \delta, q_0, F)$, where $Q = \K^n$ for some finite $n \in \N$, $\Sigma$
is a finite alphabet, $\delta \colon Q \times \Sigma \to Q$ is a transition
function such that $\delta(\cdot,a)_i$ is a polynomial in the indeterminates
$q_1, \dots, q_n$ for every $a \in \Sigma$ and every $i \in \set{1, \dots, n}$,
$q_0 \in Q$ is the initial state, and $F \colon Q \to \K$ is a polynomial
function describing the final result of the automaton. The \intro{zeroness
problem for polynomial automata} is the following decision problem: given a
\kl{polynomial automaton} $A$, is it true that for all words $w \in \Sigma^*$,
the polynomial $F(\delta^*(q_0, w))$ is zero? It is known that the \kl{zeroness
problem for polynomial automata} is decidable \cite{BEDUSHWO17}, using the
theory of \kl{Gröbner bases} on finitely many indeterminates. 

\AP Let us now propose a new model of computation called \kl{orbit finite
polynomial automata}, and prove an analogue decidability result. Let us fix a
group $\group$ that acts on the set of indeterminates $\Indets$, and on an
alphabet $\Sigma$ in an \kl{effectively oligomorphic} fashion. We write
$\K^{(\Indets)}$ for the set of finitely supported functions from $\Indets$ to
$\K$, i.e., the set of functions $f \colon \Indets \to \K$ such that there
exists a finite set $S \subseteq \Indets$ such that $f(x) = 0$ for every $x
\notin S$. Given an element $f \in \K^{(\Indets)}$, and given a polynomial $p
\in \poly{\K}{\Indets}$, we write $p(f)$ for the evaluation of $p$ on $f$.

\todo[inline]{for arka: we never defined finitely supported functions.}

\begin{definition}
  \label{def:orbit-finite-polynomial-automaton}
  An \reintro{orbit finite polynomial
  automaton} is a tuple $A \defined (Q, \Sigma, \delta, q_0, F)$, where $Q =
  \K^{(\Indets)}$, $\Sigma$ is an \kl{orbit finite} alphabet, $\delta \colon
  \Sigma \to (\Indets \to \poly{\K}{\Indets})$ is a \kl(func){finitely supported}
  polynomial update function, and $F \in \poly{\K}{\Indets}$ is a polynomial
  computing the result of the automaton. 

  Given a letter $a \in \Sigma$ and a
  state $q \in Q$, the update $\delta^*(q,a)$ is defined as the function from
  $\Indets$ to $\K$ defined by $\delta^*(q,a) \colon x \mapsto \delta(a,x)[ q ]$,
  which is well-defined because $\delta(a,x)$ is a \kl{finitely supported}
  polynomial. The update function is naturally extended to words. Finally, the
  output of an \kl{orbit finite polynomial automaton} on a word $w \in \Sigma^*$
  is defined as $F(\delta^*(q_0, w))$.
\end{definition}


\begin{example}
  \label{ex:orbit-finite-polynomial-automata}
  Let $\Indets = \calQ$, and let $\group$ be the group of all
  order-preserving bijections of $\calQ$.
  Let $\Sigma \defined \calQ \times \calQ$.
  Then, the following function are computable by 
  \kl{orbit finite polynomial automata}:
  the number $\mathrm{inc}(w)$ of letters $(a,b)$ such that $a < b$ in a word $w \in \Sigma^*$,
  the number $\mathrm{dec}(w)$ of letters $(a,b)$ such that $a > b$ in a word $w \in \Sigma^*$,
  and the number $(\mathrm{inc}(w) - \mathrm{dec}(w))^2$.
\end{example}

\AP As for \kl{polynomial automata}, the \intro(ofpa){zeroness problem} for
orbit finite polynomial automata is the following decision problem: decide if
for every input word $w$, the output $F(\delta^*(q_0, w))$ is zero. Solving the
\kl(ofpa){zeroness problem} for orbit finite polynomial automata allows us to
decide the equality of two such automata, by computing their difference. Let us
prove that the \kl(ofpa){zeroness problem} is decidable for \kl{orbit finite
polynomial automata}.

\todo[inline]{the proof of the following is incorrect and I do not know
  how to fix it easily}

\begin{theorem}
  \label{cor:orbit-finite-polynomial-automata-zeroness}
  Let $\Indets$ be a set of indeterminates that satisfies the
  \kl{computability assumptions} and such that $(\mon[Y]{\Indets}, \gdivleq)$ is a
  \kl{well-quasi-ordering}, for every \kl{well-quasi-ordered} set $(Y, \leq)$.
  Then, the \kl(ofpa){zeroness problem} is decidable for all \kl{orbit finite polynomial automata}
  with register names in $\Indets$, for every \kl{orbit finite} alphabet $\Sigma$,
  that is \kl{effectively oligomorphic} with respect to the action of $\group$.
\end{theorem}
\begin{proof}
  Let $A = (Q, \Sigma, \delta, q_0, F)$ be an \kl{orbit finite polynomial
  automaton}. Following the classical \emph{backward procedure} for such
  systems, we will compute a sequence of sets $E_0 \defined \setof{ q \in Q }{
  F(q) = 0 }$, and $E_{i+1} \defined \mathrm{pre}^\forall(E_i) \cap E_i$, where
  $\mathrm{pre}^\forall(E)$ is the set of states $q \in Q$ such that for every
  $a \in \Sigma$, $\delta^*(q,a) \in E$. We will prove that the sequence of
  sets $E_i$ stabilises, and that it is computable. As an immediate
  consequence, it suffices to check that $q_0 \in E_{\infty}$, where $E_\infty$
  is the limit of the sequence $(E_i)_{i \in \N}$, to decide the
  \kl(ofpa){zeroness problem}.

  The only idea of the proof is to notice that all the sets $E_i$ are
  representable as zero-sets of \kl{equivariant ideals} in
  $\poly{\K}{\Indets}$, allowing us to leverage the effective computations of
  \cref{cor:equivariant-ideals-computations}. Given a set $H$ of polynomials,
  we write $\mathcal{V}(H)$ the collections of states $q \in Q$ such that $p(q)
  = 0$ for all $p \in H$.
  It is easy to see that $E_0 = \mathcal{V}(\set{F}) = \mathcal{V}(\idl_0)$,
  where $\idl_0$ is the \kl{equivariant ideal} generated by $F$. 
  Furthermore, assuming that $E_i = \mathcal{V}(\idl_i)$, we can
  see that 
  \begin{align*}
    \mathrm{pre}^\forall(E_i) 
    & = \setof{ q \in Q }{ \forall a \in \Sigma, \delta^*(q,a) \in E_i } \\
    & = \setof{ q \in Q }{ \forall a \in \Sigma, \forall p \in \idl_i, p(\delta^*(q,a)) = 0 } \\
    & = \setof{ q \in Q }{ \forall p' \in \idl[J], p'(q) = 0 }
  \end{align*}
  Where, the \kl{equivariant ideal} $\idl[J]$ is generated by the
  polynomials $\mathrm{pullback}(p,a) \defined p [ x \mapsto \delta(a)(x)]$
  for every pair $(p, a) \in \idl_i \times \Sigma$. 
  As a consequence, we have $E_{i+1} = \mathcal{V}(\idl_{i+1})$, where
  $\idl_{i+1} = \idl_i + \idl[J]$.

  Because the sequence $\seqof{ \idl_i }[ i \in \N]$ is increasing, and thanks
  to the \kl{equivariant Hilbert basis property} of $\poly{\K}{\Indets}$, there
  exists an $n_0 \in \N$ such that $\idl_{n_0} = \idl_{n_0 + 1} = \idl_{n_0 +
  2} = \cdots$. In particular, we do have $E_{n_0} = E_{n_0 + 1} = E_{n_0 + 2}
  = \cdots$.

  Let us argue that we can compute the sequence $\idl_i$ effectively.
  First,  $\idl_0 = \EqIdlGen{F}$ is finitely represented.
  Now, 
  given an \kl{equivariant ideal} $\idl$, represented by an \kl{orbit finite}
  set of generators $H$,
  we can compute the \kl{equivariant ideal} $\idl[J]$ generated by the
  polynomials $\mathrm{pullback}(p,a) \defined p [ x_i \mapsto \delta(a)(x_i)]$
  for every pair $(p, a) \in H \times \Sigma$. Indeed, $H \times \Sigma$ is
  \kl{orbit finite} because the action of $\group$ on $\Indets$ is
  \kl{effectively oligomorphic}, and the function $\mathrm{pullback}$ is
  computable and \kl(func){equivariant}: indeed, given $\gelem \in \group$, we can
  show that
  \begin{align*}
    \gelem \cdot \mathrm{pullback}(p, a) & = 
    \gelem \cdot (p [ x_i \mapsto \delta(a)(x_i)]) \\
    & = p [ x_i \mapsto (\gelem \cdot \delta(a, x_i))] \\
    & = p [ x_i \mapsto \delta(\gelem \cdot a, \gelem \cdot x_i))] \\
    & = (\gelem \cdot p) [ x_i \mapsto \delta(\gelem \cdot a, x_i)] \\
    & = \mathrm{pullback}(\gelem \cdot p, \gelem \cdot a).
  \end{align*}
  
  Finally, one can detect when the sequence stabilises, by checking whether
  $\idl_i = \idl_{i+1}$, which is decidable because the
  \kl{equivariant ideal membership problem} is decidable 
  by \cref{thm:compute-egb}.

  To conclude, it remains to check whether $q_0 \in E_\infty$,
  which amounts to check that $q_0 \in \mathcal{V}(\idl_\infty)$.
  This is equivalent to checking whether for every element $p \in \Basis$
  where $\Basis$ is an \kl{equivariant Gröbner basis} of $\idl_\infty$, we have
  $p(q_0) = 0$, which can be done by enumerating relevant orbits.
\end{proof}


\begin{remark}
  \label{rem:topological-wsts}
  The notion of
  \intro{topological well-structured transition system} was introduced by
  Goubault-Larrecq in \cite{JGL07}, noticing that the pre-existing notion of
  \kl{Noetherian space} could serve as a topological generalisation of
  \kl{Noetherian rings} (where ideal-based method can be applied),
  and 
  \kl{well-quasi-orderings}, for which the celebrated decision procedures on
  \kl{well-structured transition systems} can be applied \cite{ABDU96}. In particular,
  Goubault-Larrecq used such systems to verify properties of \emph{polynomial
  programs} computing over the complex numbers, that can communicate over lossy
  channels using a finite alphabet \cite{JGL10}. 
  Because of \cref{cor:equivariant-ideals-computations}, we do have an 
  effective way to compute on the topological spaces at hand, 
  and therefore we can apply the theory of
  \kl{topological well-structured transition systems} to verify systems
  such as \emph{orbit finite polynomial automata communicating using a finite alphabet
  over lossy channels}.
  We refer to \cite[Chapter 9]{JGL13} for a survey on the theory of 
  Noetherian spaces.
\end{remark}

\paragraph{Reachability problem of symmetric data Petri nets.}

\arka{To add : symmetric VAS equations}
\todo[inline]{for arka: define symmetric data Petri nets/ symmetric VAS equations}

\paragraph{Orbit-finite systems of equations}

\todo[inline]{for arka: do it}

