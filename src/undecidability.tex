%!TEX root = ../atomic.asmart.tex
% LTeX: language=en
\section{Undecidability Results}
\label{sec:undecidability}

\todo[inline]{Aliaume: update section intro}

In this section, we will show that under certain conditions, the
\kl{equivariant ideal membership problem} is undecidable. We aim to show that
it is the case when we assume the usual effectiveness conditions on the group
action, but we do not assume that $(\mon{\Indets}, \gdivleq)$ is a
well-quasi-ordering. Beware though that there are some pathological cases where
the \kl{equivariant ideal membership problem} is undecidable even when
$(\mon{\Indets}, \gdivleq)$ is not a well-quasi-ordering, as illustrated by the
following \cref{ex:non-wqo-undecidable}.

\begin{example}
  \label{ex:non-wqo-undecidable}
  Let $\Indets = \{x_1, x_2, \ldots\}$ be an infinite set of indeterminates,
  and let $\group$ be trivial group acting on $\Indets$.
  Then, the \kl{equivariant ideal membership problem} is decidable.
\end{example}
\begin{proof}
  Because the group is trivial, whenever one provides a finite set
  $H$ of generators of an \kl{equivariant ideal} $I$, one can
  in fact work in $\poly{\K}{V}$, where $V$ is the set of indeterminates
  that appear in $H$.
  Then, the \kl{equivariant ideal membership problem} is reduces to 
  the \kl{ideal membership problem} in $\poly{\K}{V}$, which is decidable.
\end{proof}

Avoiding pathological cases such as the one in \cref{ex:non-wqo-undecidable},
we can give one positive and one negative examples that are designed to
illustrate the results we will present in this section. On the positive side,
one can consider $\Indets_\Q$, the set of all rationals equipped with their
usual ordering, and the group of all bijections of $\Indets_\Q$ that preserve
the ordering (\cref{ex:q-is-super-wqo}). While on the negative side, one can
consider $\Indets_\Z$, the set of all integers equipped with their usual
ordering, and the group of all shifts of integers (\cref{ex:z-is-not-wqo}).

\paragraph{Monomial Reachability}
The undecidability results we will present in this section regarding the
\kl{equivariant ideal membership problem} will use the polynomials in a very
limited way: we will only need to consider \emph{monomials}, and there will
even be a bound on the maximal exponent used. Before going into the details of
our reductions, let us first introduce an intermediate problem that will be
easier to work with: the (equivariant) \kl{monomial reachability problem}. 

\begin{definition}
  \label{def:mon-rewrite-system}
  A \intro{monomial rewrite system} is a finite set of pairs of the form
  $\set{\monelt, \monelt'}$ where $\monelt, \monelt' \in \mon{\Indets}$.
  The \intro{monomial reachability problem} is the problem of deciding whether
  there exists a sequence of rewrites that transforms $\monelt_s$ into $\monelt_t$
  using the rules of a monomial rewrite system $R$, where
  a \intro(monrew){rewrite step} is a pair of the form
  \begin{equation*}
    \monelt[n] (\gelem \cdot \monelt)
    \leftrightarrow_R 
    \monelt[n] (\gelem \cdot \monelt')
    \text{ if } \set{\monelt, \monelt'} \in R
    \text{ and } \gelem \in \group
    \quad .
  \end{equation*}
\end{definition}

\begin{example}
  \label{ex:mon-rewrite-system}
  Let $\Indets = \N$ and $\group$ be the set of all bijections of $\Indets$.
  Then, the rewrite system $x_1^2 x_2^2 \leftrightarrow_R x_1^2$
  satisfies $\monelt \leftrightarrow_R^* x_1^2$ if and only if 
  $\monelt$ has all its exponents that are multiple of $2$.
\end{example}

The following \cref{lem:mon-rewrite-red-membership} shows that the \kl{monomial
reachability problem} can be reduced to the \kl{equivariant ideal membership
problem}, and follows the exact same reasoning as in the case of finitely many
indeterminates \cite{MAME82}. This reduction was also noticed in \cite[Theorem
64]{GHOLAS24}.


\begin{lemma}[label=lem:mon-rewrite-red-membership,ref=lem:mon-rewrite-red-membership]
  One can solve the \kl{monomial reachability problem}
  provided that one can solve the \kl{equivariant ideal membership problem}.
\end{lemma}

In order to show that the \kl{equivariant ideal membership problem} is
undecidable, it is therefore enough to show that the \kl{monomial reachability
problem} is undecidable. To that end, we will encode the Halting problem of a
Turing machine. There are two main obstacles to overcome: first, the
reversibility of the rewriting system, which can be (partially) solved by
considering \emph{reversible} Turing machines; and second, the fact that the
configurations of the Turing machine cannot staightforwardly be encoded as
monomials due to the commutativity of the multiplication.
To overcome the second issue, we will use the following notion of 
\kl{word encoding}.

\paragraph{Structures Containing Paths.} In this section, we will assume that
the set of indeterminates $\Indets$ contains an \intro(of){infinite path} $P
\defined \seqof{x_i}[i \in \N] \subseteq \Indets$, that is, a set $P$ of
indeterminates such that $\group$ acts on $P$ as a translation of the indices.
Formally, we require that, for all $\gelem \in \group$ and for all segments $J
\defined [k,l] \subfin \N$ such that $\gelem \cdot x_j \subseteq P$ for all $j
\in J$, there exists $n \in \N$ such that $\gelem \cdot x_j = x_{j + n}$ for
all $j \in J$ ; and there exists a $\gelem_{+1} \in \group$ such that
$\gelem_{+1} \cdot x_i = x_{i + 1}$ for all $i \in \N$. The prototypical
example being the set of all indeterminates $\Indets = \Z$ equipped with the
group $\group$ of all shifts.

\begin{remark}
  \label{rem:not-wqo}
  If there exists a \kl{word encoding} for a binary alphabet $\Sigma$, then
  $(\mon{\Indets}, \gdivleq)$ is not a \kl{well-quasi-ordering}.
  Indeed, the infix ordering relation on words over a binary alphabet is
  not a \kl{well-quasi-ordering}, as shown by the infinite antichain
  $\setof{ a b^n a}{n \in \N }$,
  and the \kl{word encoding} $\wenc{\cdot}$ is an order embedding of
  the infix ordering relation on words over $\Sigma$ into $(\mon{\Indets}, \gdivleq)$.
\end{remark}


\AP Let us fix a binary alphabet $\Sigma \defined \set{a,b}$, and let us define
a function $\intro*\wenc{ \cdot} \colon \Sigma^* \to \mon{\Indets}$, where
$\Sigma$ is a finite alphabet, that encodes a word $u \in \Sigma^*$ as a
monomial. Namely, we define inductively $\wenc{\varepsilon} \defined 1$,
$\wenc{a u} = x_0^3 x_1^2 x_2^1 x_3^3 (\gelem_{+4} \cdot \wenc{u})$ and
$\wenc{b u} = x_0^3 x_1^1 x_2^2 x_3^3 (\gelem_{+4} \cdot \wenc{u})$ for all $u
\in \Sigma^*$. Let us remark that \kl{monomial rewriting} applied on \kl{word
encodings} can simulate (reversible) string rewriting on words of a given size.

\begin{lemma}
  \label{lem:word-encoding-string-subst}
  Let $u,v,w \in \Sigma^*$ be three words, such that $|u| = |v|$,
  and let $\monelt[n] \in \mon{\Indets}$ be a monomial.
  The following are equivalent:
  \begin{enumerate}
    \item There exists $\gelem \in \group$
      such that $\wenc{w} = \monelt[m] (\gelem \cdot \wenc{u})$
      and $\monelt[n] = \monelt[m] (\gelem \cdot \wenc{v})$,
    \item There exists $x, y \in \Sigma^*$
      such that $x u y = w$ and $\wenc{x v y} = \monelt[n]$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  \textbf{aliaume todo}
\end{proof}

Note that without loss of generality, thanks to
\cref{lem:word-encoding-string-subst}, we can assume that the alphabet is any
finite set, using a suitable unambiguous encoding of the alphabet into a binary
alphabet \cite{BERST09}. This bigger alphabet size will simplify the statement
and proof of the following \cref{lem:reversible-machine}, which explains how
to simulate a reversible Turing machine using \kl{monomial rewriting}. Given a
reversible Turing machine $M$ with a finite set $Q$ of states and tape alphabet
$\Sigma$, we will consider the following alphabet $\Gamma \defined \set{
\triangleleft, \triangleright } \times \set{ \text{pre}, \text{run},
\text{post} } \uplus Q \uplus \Sigma \uplus \set{ \square, \square_1, \square_2}$. The letter
$\square$ is a blank symbol, and the letters $\triangleleft$ and
$\triangleright$ are used to delimit the beginning and the end of the tape,
with some extra ``phase information''.

\begin{lemma}
  \label{lem:reversible-machine}
  There exists a
  \kl{monomial rewrite system} $R_M$ such that the following
  are equivalent for every $n \geq 1$:
  \begin{enumerate}
    \item $\wenc{ \triangleright^{\text{pre}} \square^n 
                  \triangleleft^{\text{pre}}
     } \leftrightarrow_{R_M}^* 
     \wenc{ \triangleright^{\text{post}} \square^n 
                  \triangleleft^{\text{post}} }$,
      \item $M$ halts on the empty word using a tape bounded by $n-1$ cells.
  \end{enumerate}
  Furthermore, every monomial that is 
  reachable from $\wenc{ \triangleright^{\text{pre}} \square^n \triangleleft^{\text{pre}} }$
  or $\wenc{ \triangleright^{\text{post}} \square^n \triangleleft^{\text{post}} }$
  is the image of a word of the form
  $\wenc{\triangleright^{\text{run}} u \triangleleft^{\text{run}}}$  
  where $u \in (Q \uplus \Sigma \uplus \square)^n$.
\end{lemma}
\begin{proof}
  The rewrite system simply acts on the tape of the reversible Turing machine 
  using blank symbols. Because transitions of the reversible Turing machine
  are substitutions of strings having the same size if one does not create new
  tape cells, the rewriting system can straigthforwardly simulate the 
  substitutions because of \cref{lem:word-encoding-string-subst}.
  To this monomial rewriting system, we add two rules,
  respectively of the form
  $\wenc{ \triangleright^{\text{pre}} \square^n \triangleleft^{\text{pre}} }
  \leftrightarrow_{R_M}^*
  \wenc{ \triangleright^{\text{run}} q_0 \square^{n-1} \triangleleft^{\text{run}} }$
  and 
  $\wenc{ \triangleright^{\text{post}} \square^n \triangleleft^{\text{post}} }
  \leftrightarrow_{R_M}^*
  \wenc{ \triangleright^{\text{run}} q_f \square^{n-1} \triangleleft^{\text{run}} }$,
  where $q_0$ is the initial state of the Turing machine $M$ and $q_f$ is its
  final state.
  This is not problematic because one can 
  simply write $\wenc{\triangleright^{\text{run}} q_0} (\gelem \cdot \wenc{\triangleleft^{\text{run}}})$
  for a suitable $\gelem \in \group$, in order
  to ignore the number of blank symbols in the tape,
  and because we can assume that the reversible Turing machine
  starts with a clean tape and ends with a clean tape.
\end{proof}

\Cref{lem:reversible-machine} shows that one can simulate the runs, provided we
know in advance the maximal size of the tape used by the reversible Turing
machine. The key ingredient that remains to be explained is how one can start
from a finite monomial $\monelt$ and create a tape of arbitrary size using a
\kl{monomial rewrite system}. Note that because the set of indeterminates can
very well contain multiple copies of an \kl(of){infinite path} $P$, we will not
be able to guarantee that we create exactly the tape $\wenc{
\triangleright^{\text{pre}} \square^n \triangleleft^{\text{pre}} }$ for some $n
\in \N$, but rather that we can find some equivalent monomial up to the action
of $\group$.

\begin{lemma}
  \label{lem:tape-creation}
  There exists a \kl{monomial rewrite system} $R_\text{pre}$
  such that for every monomial $\monelt \in \mon{\Indets}$, the following are
  equivalent:
  \begin{enumerate}
    \item $\wenc{ \triangleright^{\text{pre}} \square \triangleleft^{\text{pre}}} 
      \leftrightarrow_{R_\text{pre}}^* 
      \monelt$
    \item there exists $n \in \N$ and $\gelem \in \group$, such that
      $\gelem \cdot \monelt = \wenc{ \triangleright^{\text{pre}} \square^n 
                        \triangleleft^{\text{pre}} }$.
  \end{enumerate}
  Similarly, there exists a \kl{monomial rewrite system} $R_\text{post}$
  with analogue properties.
\end{lemma}
\begin{proof}
  The rewrite system is going to have two phases.
  In a first phase, we will consider the rules
  $\wenc{ \square \triangleleft^{\text{pre}} } \leftrightarrow_{R_\text{pre}}
   \wenc{ \square \square \triangleleft^{\text{pre}} }$.
  This is \emph{almost} leading to the desired \kl{word encoding}.
  The only thing left to check is that we do not reuse indeterminates when 
  creating new letters.
  To ensure that we did not, we will implement the 
  Floyd cycle-finding algorithm, which uses two pointers moving at different speeds.
  To that end, we will use two new blank symbols $\square_1$ and $\square_2$,
  and the rules 
  $\wenc{ \square_1 \square } ( \gelem \cdot \wenc{ \square_2 \square \square })
  \leftrightarrow_{R_\text{pre}}
  \wenc{ \square \square_1 } (\gelem \cdot \wenc{ \square \square \square_2 })$,
  where $\pi$ is a permutation of the indeterminates that ensures that the
  indetermitates of the two words are distinct.
  Finally, one adds the possibility to switch to the second phase,
  and end the second phase when pointer $\square_2$ reaches the end of the tape.

  \todo[inline]{Aliaume: complete the proof}
\end{proof}

\csname thm:undecidable-paths\endcsname
\begin{proof}
  It suffices to combine the rewriting systems $R_M$, $R_\text{pre}$ and 
  $R_\text{post}$ by taking their union.
\end{proof}


\begin{remark}
  \label{rem:more-generally}
  The undecidability result of \cref{cor:undecidability} can be generalized to
  any set of indeterminates in which one can encode words over a binary alphabet,
  and for which there is a \kl{monomial rewrite system} that can
  produce arbitrary long words.
  We strongly conjecture that this is the case for 
  the \kl{infinite dimensional vector space}
  \todo{cite ref}
\end{remark}
